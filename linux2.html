<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Linux Commandes - Référence Terminale</title>
    <!-- Chargement de Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Configuration du thème sombre et de la police monospace pour l'effet terminal */
        body {
            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
            background-color: #111827; /* Gris très foncé / Noir */
            color: #d1d5db; /* Texte gris clair */
            scroll-behavior: smooth;
        }

        /* Styles spécifiques pour les blocs de code et l'interaction */
        .command-block {
            background-color: #1f2937; /* Gris foncé pour le bloc */
            border-left: 4px solid #34d399; /* Barre latérale Cyan/Vert */
            padding: 1rem;
            margin-bottom: 1rem;
            border-radius: 0.375rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
        }
        
        .command-code {
            background-color: #000000; /* Fond noir pur pour la commande */
            color: #34d399; /* Vert fluo pour la commande */
            padding: 0.5rem 0.75rem;
            border-radius: 0.375rem;
            font-size: 0.95rem;
            cursor: pointer;
            transition: background-color 0.2s, box-shadow 0.2s; 
            position: relative; 
            display: flex;
            justify-content: space-between;
            align-items: center;
            overflow-x: auto;
            white-space: nowrap;
        }
        
        /* Couleur au survol */
        .command-code:hover {
            background-color: #0d1217; 
        }

        /* Classe ajoutée au clic pour le feedback visuel (copie) */
        .command-code.copied-feedback {
            background-color: #166534; /* Vert foncé/militaire */
            box-shadow: 0 0 10px rgba(52, 211, 153, 0.5); /* Ombre légère verte */
        }

        /* Style du bouton de navigation par défaut */
        .nav-anchor {
            transition: all 0.2s ease-in-out;
            border: 1px solid #34d399;
            background-color: #1f2937;
        }

        /* Style du bouton de navigation ACTIF (maintenu après clic) */
        .nav-anchor.active {
            background-color: #34d399 !important; /* Vert fluo permanent */
            color: #111827 !important; /* Texte noir */
            border-color: #34d399 !important;
            box-shadow: 0 0 12px rgba(52, 211, 153, 0.8);
        }
        
        /* Message de confirmation de copie (Toast) */
        .toast-message {
            position: absolute;
            top: 50%; 
            left: 50%; 
            transform: translate(-50%, -50%); 
            white-space: nowrap; 
            opacity: 0; 
            transition: opacity 0.3s ease-in-out; 
            pointer-events: none; 
            z-index: 50; 
            padding: 0.25rem 0.75rem;
            background-color: #34d399; /* Vert fluo */
            color: #111827; /* Texte sombre */
            border-radius: 0.25rem;
            font-size: 0.8rem;
            font-weight: bold;
            letter-spacing: 0.05em;
        }

        /* Styles pour les notes avancées */
        .advanced-note {
             background-color: #252538; 
             border-left: 4px solid #8b5cf6; 
             padding: 1rem;
             border-radius: 0.5rem;
             margin-top: 2rem;
        }
        .advanced-note p {
            color: #d8b4fe; 
        }
        
        /* Styles pour les titres de section */
        .section-title {
            color: #60a5fa; 
            border-bottom: 2px solid #3b82f6;
            padding-bottom: 0.5rem;
        }
        
        /* Styles pour le titre principal */
        #main-title {
            background-color: rgba(0, 0, 0, 0.5); 
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
        }

        /* Masquer la barre de défilement (pour le style) */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-thumb {
            background: #374151;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-track {
            background: #1f2937;
        }
    </style>
    <!-- Icônes SVG basées sur Lucide -->
    <script>
        // Variable globale pour suivre la section active (celle sur laquelle on a cliqué)
        window.activeSectionId = 'manipulation'; 

        function getIcon(name, classes = "w-6 h-6") {
            const icons = {
                'tux': '<svg fill="#d1d5db" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" stroke="#d1d5db" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" class="'+classes+'"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm3.5 12.5c-.32.61-1.09 1.5-3.5 1.5s-3.18-.89-3.5-1.5a1 1 0 0 1 0-1c.32-.61 1.09-1.5 3.5-1.5s3.18.89 3.5 1.5a1 1 0 0 1 0 1zM9.5 9c-.83 0-1.5.67-1.5 1.5S8.67 12 9.5 12s1.5-.67 1.5-1.5S10.33 9 9.5 9zm5 0c-.83 0-1.5.67-1.5 1.5S13.67 12 14.5 12s1.5-.67 1.5-1.5S15.33 9 14.5 9z"></path></svg>',
                'copy': '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#d1d5db" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2v10c0 1.1-.9 2-2 2H4z"/></svg>',
                'folder-open': '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="'+classes+'"><path d="M19 20a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h3l2-2h4a2 2 0 0 1 2 2v10Z"/><path d="M10 12h4"/><path d="M12 10v4"/></svg>',
                'users': '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="'+classes+'"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>',
                'lock': '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="'+classes+'"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 0 0 1 10 0v4"/></svg>',
                'shield': '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="'+classes+'"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>',
            };
            // Appliquer la couleur d'accentuation pour les icônes de section
            let accentColor = '';
            if (name !== 'tux' && name !== 'copy') {
                accentColor = 'text-green-400';
            }
            // Utiliser le vert fluo par défaut si la couleur d'accentuation n'est pas nécessaire (pour les icônes de section)
            return icons[name] ? icons[name].replace('currentColor', '#34d399') : '';
        }
    </script>
</head>
<body class="min-h-screen">

    <div id="app" class="max-w-6xl mx-auto p-4 sm:p-6 lg:p-8">

        <!-- En-tête (TRANSPARENT avec style Terminal) -->
        <header class="bg-transparent p-6 mb-8 flex flex-col items-center">
            <div id="main-title" class="flex items-center space-x-4 mb-4 shadow-2xl shadow-green-900/50">
                <div class="text-white">
                    <script>document.write(getIcon('tux', 'w-12 h-12'));</script>
                </div>
                <h1 class="text-4xl font-extrabold text-green-400">
                    <span class="text-cyan-400">ADMIN</span>-LINUX <span class="text-yellow-400">REFERENCE</span>
                </h1>
            </div>
            <p class="text-gray-400 mt-2 text-center text-sm">Référence complète des commandes d'administration système. Cliquez sur une commande pour la copier.</p>
        </header>

        <!-- Navigation Fixe (Ancres) - Liens en forme de BOUTONS -->
        <nav class="sticky top-0 z-10 bg-gray-900/90 backdrop-blur-sm p-3 rounded-xl mb-8 border border-gray-700">
            <div id="anchor-nav" class="flex flex-wrap justify-center gap-3 sm:gap-4 text-sm font-semibold">
                <!-- Liens de navigation injectés ici -->
            </div>
        </nav>

        <!-- Contenu Principal -->
        <main id="main-content">
            <!-- Les sections de commandes seront injectées ici -->
        </main>

        <!-- Pied de Page -->
        <footer class="mt-12 py-6 border-t border-gray-700">
            <div class="text-center text-sm text-gray-500">
                <p id="copyright-text"></p>
                <p>Système créé pour la référence rapide et l'apprentissage.</p>
            </div>
        </footer>

    </div>

    <script>
        // --- DONNÉES DU COURS ---
        const COURSE_DATA = [
            {
                id: 'manipulation',
                title: '1. Manipulation de Fichiers & Répertoires',
                icon: 'folder-open',
                accent: 'text-cyan-400',
                commands: [
                    { cmd: 'touch rapport.txt', role: 'Crée un fichier vide.', option: 'Aucune', use: 'touch rapport.txt', explanation: 'Souvent utilisée pour créer des fichiers temporaires ou des "fichiers drapeaux" (flag files).' },
                    { cmd: 'mkdir -p /projet/logs', role: 'Crée un répertoire (dossier).', option: '-p (créer les répertoires parents manquants)', use: 'mkdir -p /projet/logs', explanation: "S'assurer qu'un répertoire de destination existe avant d'y copier des fichiers." },
                    { cmd: 'cp -R /etc/skel /home/nouvel_user', role: 'Copie des fichiers ou des répertoires.', option: '-R (récursif, obligatoire pour les dossiers)', use: 'cp -R /etc/skel /home/nouvel_user', explanation: 'Créer des sauvegardes ou dupliquer des fichiers de configuration.' },
                    { cmd: 'mv /tmp/file.log /var/log/archive', role: 'Déplace un fichier ou un répertoire.', option: 'Aucune', use: 'mv /tmp/file.log /var/log/archive', explanation: "Déplacer des fichiers après traitement vers un dossier d'archive." },
                    { cmd: 'mv old.txt new_name.txt', role: 'Renomme un fichier.', option: 'Aucune', use: 'mv old.txt new_name.txt', explanation: "Le déplacement d'un fichier vers le même répertoire avec un nouveau nom le renomme." },
                    { cmd: 'rmdir ancien_dossier', role: 'Supprime un répertoire **vide**.', option: 'Aucune', use: 'rmdir ancien_dossier', explanation: "Utilisé pour le nettoyage après qu'un script a traité et retiré tous les fichiers." },
                    { cmd: 'rm -rf dossier_a_supprimer', role: 'Supprime un fichier ou un répertoire.', option: '-r (récursif), -f (force)', use: 'rm -rf dossier_a_supprimer', explanation: 'Supprimer des fichiers individuels (attention, pas de corbeille !)' },
                    { cmd: 'cat /etc/hosts', role: 'Affiche le contenu d\'un fichier sur la sortie standard.', option: 'Aucune', use: 'cat /etc/hosts', explanation: 'Vérifier rapidement le contenu d\'un fichier de log ou de configuration.' },
                    { cmd: 'less /var/log/syslog', role: 'Affiche le contenu page par page.', option: 'Aucune', use: 'less /var/log/syslog', explanation: 'Idéal pour les grands fichiers. (Utilisez q pour quitter).' },
                    { cmd: 'tail -n 10 /var/log/messages', role: 'Affiche le début (head) ou la fin (tail) d\'un fichier.', option: '-n [nombre] (nombre de lignes)', use: 'tail -n 10 /var/log/messages', explanation: 'Utile pour monitorer les logs en temps réel (tail -f).' },
                    { cmd: 'file /usr/bin/bash', role: 'Détermine le type de fichier.', option: 'Aucune', use: 'file /usr/bin/bash', explanation: "Utile pour s'assurer qu'on manipule le bon type de fichier (texte, exécutable, lien, etc.)." },
                ],
                advanced_notes: `
                    <div class="text-sm advanced-note shadow-lg">
                        <p class="font-bold mb-2 text-lg text-yellow-400">NOTES AVANCÉES - FICHIERS</p>
                        <ul class="list-disc list-inside space-y-1 text-gray-300 ml-4">
                            <li><code class="text-green-400">grep</code> : Recherche un motif (texte) dans un fichier. (Ex: <code class="text-green-400">grep "erreur" /var/log/syslog</code>)</li>
                            <li><code class="text-green-400">find</code> : Recherche de fichiers et répertoires dans l'arborescence. (Ex: <code class="text-green-400">find /home -name "*.txt"</code>)</li>
                            <li><code class="text-green-400">tar</code> : Utilitaire pour archiver et compresser. (Ex: <code class="text-green-400">tar -czvf archive.tgz /dossier</code>)</li>
                        </ul>
                    </div>
                `
            },
            {
                id: 'users_groups',
                title: '2. Utilisateurs & Groupes',
                icon: 'users',
                accent: 'text-yellow-400',
                commands: [
                    { cmd: 'whoami', role: 'Affiche le nom de l’utilisateur effectif actuel.', option: 'Aucune', use: 'whoami', explanation: '' },
                    { cmd: 'id', role: 'Affiche l\'UID, GID et les groupes de l\'utilisateur.', option: '-u (UID), -g (GID), -G (tous les groupes)', use: 'id', explanation: '' },
                    { cmd: 'sudo apt update', role: 'Exécuter une commande avec les droits du superutilisateur.', option: '-i (ouvrir un shell root)', use: 'sudo apt update', explanation: 'Nécessite d\'être membre du groupe `sudo` ou d\'avoir une entrée dans `/etc/sudoers`.' },
                    { cmd: 'sudo useradd -m nouvel_employe', role: 'Ajouter un nouvel utilisateur au système.', option: '-m (créer le répertoire personnel)', use: 'sudo useradd -m nouvel_employe', explanation: 'Crée l\'utilisateur, mais le mot de passe doit être défini séparément avec `passwd`.' },
                    { cmd: 'sudo passwd nouvel_employe', role: 'Changer le mot de passe d\'un utilisateur (ou le vôtre).', option: 'Aucune', use: 'sudo passwd nouvel_employe', explanation: 'Si utilisé par root ou sudo, permet de définir le mot de passe de n\'importe quel utilisateur.' },
                    { cmd: 'sudo usermod -aG sudo nouvel_employe', role: 'Modifier les propriétés d\'un utilisateur existant.', option: '-aG [groupe] (ajouter à un groupe), -l (changer login)', use: 'sudo usermod -aG sudo nouvel_employe', explanation: 'Utilisez `chage -l [user]` pour voir les informations sur l\'expiration du mot de passe.' },
                    { cmd: 'sudo groupadd devops', role: 'Ajouter un nouveau groupe.', option: 'Aucune', use: 'sudo groupadd devops', explanation: '' },
                    { cmd: 'sudo userdel -r ancien_employe', role: 'Supprimer un utilisateur.', option: '-r (supprimer le répertoire personnel et les spools de courrier)', use: 'sudo userdel -r ancien_employe', explanation: 'Vérifiez toujours l\'impact avant de supprimer.' },
                ],
                advanced_notes: `
                    <div class="text-sm advanced-note shadow-lg">
                        <p class="font-bold mb-2 text-lg text-yellow-400">NOTES AVANCÉES - FICHIERS SYSTÈME CLÉS</p>
                        <ul class="list-disc list-inside space-y-1 text-gray-300 ml-4">
                            <li><code class="text-pink-400">/etc/passwd</code> : Informations utilisateurs (Login, UID, GID, Shell).</li>
                            <li><code class="text-pink-400">/etc/shadow</code> : Mots de passe hachés et infos d'expiration. (Accès restreint)</li>
                            <li><code class="text-pink-400">/etc/group</code> : Liste les groupes et leurs membres.</li>
                            <li><code class="text-pink-400">/etc/sudoers</code> : Configuration de la commande sudo (éditer avec <code class="text-green-400">visudo</code>).</li>
                        </ul>
                    </div>
                `
            },
            {
                id: 'permissions',
                title: '3. Gestion des Permissions (CHMOD/CHOWN)',
                icon: 'lock',
                accent: 'text-red-400',
                commands: [
                    { cmd: 'ls -l /etc/shadow', role: 'Affiche le détail des permissions (rwxrwxrwx) et la propriété.', option: 'Aucune', use: 'ls -l /etc/shadow', explanation: 'Le premier caractère indique le type de fichier (d pour répertoire, - pour fichier).' },
                    { cmd: 'chmod 755 script.sh', role: 'Change les permissions d\'accès en notation octale (7=rwx, 6=rw-, 5=r-x...).', use: 'chmod 755 script.sh', explanation: '755 donne (rwx pour l\'utilisateur, r-x pour le groupe et les autres).' },
                    { cmd: 'chmod u+x,go-w rapport.txt', role: 'Change les permissions avec u/g/o/a (user/group/other/all) et +/=/-(add/set/remove).', use: 'chmod u+x,go-w rapport.txt', explanation: 'Ajoute l\'exécution à l\'utilisateur, enlève l\'écriture au groupe et aux autres.' },
                    { cmd: 'sudo chown alice fichier.log', role: 'Change le **propriétaire** d\'un fichier ou répertoire.', option: '-R (récursif)', use: 'sudo chown alice fichier.log', explanation: 'Nécessite souvent les droits du superutilisateur.' },
                    { cmd: 'sudo chown alice:devops fichier.log', role: 'Change le propriétaire ET le groupe simultanément.', option: 'Aucune', use: 'sudo chown alice:devops fichier.log', explanation: 'Séparer le propriétaire et le groupe par un deux-points.' },
                    { cmd: 'sudo chgrp devops /var/www/html', role: 'Change uniquement le **groupe** d\'un fichier.', option: '-R (récursif)', use: 'sudo chgrp devops /var/www/html', explanation: '' },
                ],
                advanced_notes: `
                    <div class="text-sm advanced-note shadow-lg">
                        <p class="font-bold mb-2 text-lg text-yellow-400">NOTES AVANCÉES - NOTATION OCTALE</p>
                        <ul class="list-disc list-inside space-y-1 text-gray-300 ml-4">
                            <li>**4 :** Lecture (r)</li>
                            <li>**2 :** Écriture (w)</li>
                            <li>**1 :** Exécution (x)</li>
                            <li>**7 (4+2+1) :** Lecture, Écriture, Exécution (rwx)</li>
                            <li>**Exemple :** <code class="text-green-400">750</code> = Propriétaire (rwx), Groupe (r-x), Autres (---).</li>
                        </ul>
                    </div>
                `
            },
            {
                id: 'network_firewall',
                title: '4. Réseau & Pare-feu (UFW)',
                icon: 'shield',
                accent: 'text-blue-400',
                commands: [
                    { cmd: 'ip addr show', role: 'Affiche les adresses IP et les informations des interfaces réseau.', option: 'show', use: 'ip addr show', explanation: 'Remplace l\'ancienne commande `ifconfig`.' },
                    { cmd: 'ping -c 4 google.com', role: 'Teste la connectivité réseau et la résolution de nom.', option: '-c [nombre] (nombre de paquets)', use: 'ping -c 4 google.com', explanation: 'Un taux de perte (loss) de 0% indique une bonne connexion.' },
                    { cmd: 'sudo netstat -tulpn | grep 80', role: 'Affiche les connexions réseau actives et les ports ouverts.', option: '-tulpn (TCP, UDP, Listening, Numérique, Processus)', use: 'sudo netstat -tulpn | grep 80', explanation: 'Nécessite souvent `sudo` pour voir les noms de processus.' },
                    { cmd: 'ssh utilisateur@serveur.com -p 2222', role: 'Client pour connexion à distance sécurisée (Secure Shell).', option: '-i [clé] (clé privée pour authentification)', use: 'ssh utilisateur@serveur.com -p 2222', explanation: 'Port par défaut est 22.' },
                    { cmd: 'sudo ufw status numbered', role: 'Vérifie l\'état et les règles actives du pare-feu UFW.', option: 'verbose (détails), numbered (avec numéro de ligne)', use: 'sudo ufw status numbered', explanation: 'UFW est l\'outil simplifié pour gérer Netfilter/iptables.' },
                    { cmd: 'sudo ufw allow 80/tcp', role: 'Autorise l\'accès à un port ou un service.', option: 'from [ip] (spécifier l\'IP source)', use: 'sudo ufw allow 80/tcp', explanation: 'Port 80 pour HTTP.' },
                    { cmd: 'sudo ufw deny from 192.168.1.100', role: 'Bloque l\'accès à un port ou un service.', option: 'from [ip]', use: 'sudo ufw deny from 192.168.1.100', explanation: 'Bloque le trafic d\'une IP spécifique.' },
                    { cmd: 'sudo ufw enable', role: 'Active le pare-feu et applique les règles.', option: 'Aucune', use: 'sudo ufw enable', explanation: 'Attention : peut vous déconnecter si SSH n\'est pas autorisé avant.' },
                ],
                advanced_notes: `
                    <div class="text-sm advanced-note shadow-lg">
                        <p class="font-bold mb-2 text-lg text-yellow-400">RÈGLES DE BASE UFW</p>
                        <table class="w-full text-left text-xs sm:text-sm mt-3 border-collapse">
                            <tbody class="divide-y divide-gray-700">
                                <tr>
                                    <td class="pr-4 py-2 font-bold text-red-400">IN Default</td>
                                    <td class="py-2"><code class="text-green-400">sudo ufw default deny incoming</code></td>
                                    <td class="py-2 text-gray-400">Bloque tout le trafic entrant.</td>
                                </tr>
                                <tr>
                                    <td class="pr-4 py-2 font-bold text-green-400">OUT Default</td>
                                    <td class="py-2"><code class="text-green-400">sudo ufw default allow outgoing</code></td>
                                    <td class="py-2 text-gray-400">Autorise les requêtes sortantes.</td>
                                </tr>
                                <tr>
                                    <td class="pr-4 py-2 font-bold text-yellow-400">Autoriser SSH</td>
                                    <td class="py-2"><code class="text-green-400">sudo ufw allow ssh</code></td>
                                    <td class="py-2 text-gray-400">Port 22, essentiel.</td>
                                </tr>
                                <tr>
                                    <td class="pr-4 py-2 font-bold text-yellow-400">Activer</td>
                                    <td class="py-2"><code class="text-green-400">sudo ufw enable</code></td>
                                    <td class="py-2 text-gray-400">Démarrer le pare-feu.</td>
                                </tr>
                            </tbody>
                        </table>
                        <p class="mt-4 text-xs italic text-gray-500">// Suppression: <code class="text-green-400">sudo ufw delete [NUMÉRO]</code></p>
                    </div>
                `
            }
        ];

        // --- Fonctions d'Interactivité & Copie ---

        function fallbackCopyTextToClipboard(text) {
            const textArea = document.createElement("textarea");
            textArea.value = text;
            textArea.style.position = "fixed";
            textArea.style.top = "-9999px";
            textArea.style.left = "-9999px";
            document.body.appendChild(textArea);
            
            textArea.select();
            
            try {
                // Utilisation de document.execCommand('copy') pour la compatibilité iFrame
                document.execCommand('copy'); 
            } catch (err) {
                console.error('Erreur lors de la copie de secours', err);
            }
            document.body.removeChild(textArea);
        }

        // Affiche le message "Copié !" et le feedback de couleur pour les COMMANDES
        function showToastAndFeedback(targetElement) {
            // 1. Afficher le message "COPIÉ !"
            let toast = targetElement.querySelector('.toast-message');
            if (!toast) {
                toast = document.createElement('div');
                toast.className = 'toast-message';
                toast.textContent = 'COPIÉ !';
                targetElement.appendChild(toast);
            }
            toast.style.opacity = '1';

            // 2. Ajouter la classe de feedback visuel
            targetElement.classList.add('copied-feedback');

            // 3. Masquer le message et retirer la classe après 700ms
            setTimeout(() => {
                toast.style.opacity = '0';
                targetElement.classList.remove('copied-feedback'); // Retirer la couleur de fond
            }, 700); 
        }
        
        // Fonction principale de gestion du clic de COMMANDE
        function copyToClipboard(event, text) {
            fallbackCopyTextToClipboard(text);
            showToastAndFeedback(event.currentTarget);
        }

        // Fonction de gestion du clic sur les ANCRES de navigation
        function anchorClicked(targetId) {
            // 1. Mettre à jour l'ID de la section active
            window.activeSectionId = targetId;
            
            // 2. Re-rendre la navigation pour appliquer la nouvelle classe 'active'
            renderAnchorNav();

            // 3. Effectuer le défilement vers la section nativement via l'ancre href
            // (Le navigateur gère déjà le scroll grâce à l'attribut href="#id" dans le HTML)
        }


        // --- Fonctions de Rendu HTML ---

        // Rendu de la Navigation (Liens d'ancrage en style bouton)
        function renderAnchorNav() {
            const navContainer = document.getElementById('anchor-nav');
            if (!navContainer) return;

            navContainer.innerHTML = COURSE_DATA.map(item => `
                <a href="#${item.id}" 
                   class="nav-anchor px-4 py-2 rounded-full transition-all duration-200 text-sm font-bold uppercase tracking-wider 
                          ${item.id === window.activeSectionId ? 'active' : 'text-green-400 hover:bg-green-600 hover:text-gray-900'} 
                          shadow-md hover:shadow-green-500/50"
                   onclick="window.anchorClicked('${item.id}')"
                >
                    ${item.title.split('. ')[1].replace('&', 'et')}
                </a>
            `).join('');
        }
        
        // Rendu du Contenu Principal (Sections)
        function renderContent() {
            const container = document.getElementById('main-content');
            if (!container) return;

            container.innerHTML = COURSE_DATA.map(section => `
                <section id="${section.id}" class="mb-12 pt-4">
                    <h2 class="section-title text-3xl font-extrabold mb-6 flex items-center space-x-3 ${section.accent}">
                        <span class="w-8 h-8">${getIcon(section.icon)}</span>
                        <span>${section.title}</span>
                    </h2>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        ${section.commands.map(cmd => `
                            <div class="command-block h-full flex flex-col justify-between">
                                <div>
                                    <div class="flex items-center justify-between mb-2">
                                        <h3 class="text-2xl font-bold text-green-400">${cmd.cmd.split(' ')[0]}</h3>
                                    </div>

                                    <!-- Rôle et Explication -->
                                    <p class="text-gray-400 mb-2 italic text-sm">${cmd.role}</p>
                                    <p class="text-gray-300 mb-4 text-xs">${cmd.explanation}</p>
                                    
                                    <!-- Options Clés -->
                                    ${cmd.option && cmd.option !== 'Aucune' ? `
                                        <div class="text-xs text-gray-500 mb-4 p-2 bg-gray-800 rounded-lg border border-gray-700">
                                            <span class="font-semibold text-cyan-400 block mb-1">Options:</span> 
                                            <span>${cmd.option}</span>
                                        </div>` : ''}
                                </div>

                                <!-- Bloc de Commande Cliquable -->
                                <div class="mt-auto pt-4 border-t border-gray-800">
                                    <p class="text-xs font-semibold uppercase text-gray-500 mb-1">UTILISATION (Cliquez)</p>
                                    <!-- Ajout du gestionnaire d'événement et du conteneur de message -->
                                    <div class="command-code" onclick="window.copyToClipboard(event, '${cmd.use.replace(/'/g, "\\'")}')">
                                        <code class="truncate">${cmd.use}</code>
                                        <span class="text-gray-600 ml-3">${getIcon('copy', 'w-4 h-4')}</span>
                                        <!-- Le toast sera géré ici -->
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <!-- Notes Avancées/Tableau UFW -->
                    ${section.advanced_notes || ''}

                </section>
            `).join('');
        }
        
        // Initialisation de l'application
        document.addEventListener('DOMContentLoaded', () => {
            // Mise à jour du copyright
            const currentYear = new Date().getFullYear();
            const copyrightElement = document.getElementById('copyright-text');
            if (copyrightElement) {
                 copyrightElement.textContent = `© ${currentYear} Mamadou MBAYE | Terminal Admin Linux.`;
            }
            
            // Rendu initial de la navigation (activeSectionId par défaut = 'manipulation')
            renderAnchorNav(); 
            
            // Rendu du contenu
            renderContent();

            // Rendre les fonctions globales pour les clics
            window.copyToClipboard = copyToClipboard;
            window.anchorClicked = anchorClicked;
        });
    </script>
</body>
</html>
